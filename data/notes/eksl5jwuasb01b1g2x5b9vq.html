<h1 id="excel-files"><a aria-hidden="true" class="anchor-heading icon-link" href="#excel-files"></a>Excel Files</h1>
<h2 id="pdexcelfile"><a aria-hidden="true" class="anchor-heading icon-link" href="#pdexcelfile"></a>pd.ExcelFile</h2>
<p><a href="https://stackoverflow.com/a/17977609/12339658">https://stackoverflow.com/a/17977609/12339658</a></p>
<pre class="language-python"><code class="language-python">xl <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelFile<span class="token punctuation">(</span><span class="token string">'foo.xls'</span><span class="token punctuation">)</span>

xl<span class="token punctuation">.</span>sheet_names  <span class="token comment"># see all sheet names</span>

xl<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>sheet_name<span class="token punctuation">)</span>  <span class="token comment"># read a specific sheet to DataFrame</span>
</code></pre>
<p><a href="https://pythoninoffice.com/read-multiple-excel-sheets-with-python-pandas/#:~:text=00%3A00%3A00-,pd.ExcelFile(),-With%20this%20approach">https://pythoninoffice.com/read-multiple-excel-sheets-with-python-pandas/#:~:text=00%3A00%3A00-,pd.ExcelFile(),-With%20this%20approach</a></p>
<pre class="language-python"><code class="language-python">f <span class="token operator">=</span> pd<span class="token punctuation">.</span>ExcelFile<span class="token punctuation">(</span><span class="token string">'users.xlsx'</span><span class="token punctuation">)</span>
f
<span class="token comment"># >>> &#x3C;pandas.io.excel._base.ExcelFile object at 0x00000138DAE66670></span>
f<span class="token punctuation">.</span>sheet_names
<span class="token comment"># >>> ['User_info', 'purchase', 'compound', 'header_row5']</span>
<span class="token comment"># To get data from a sheet, we can use the parse() method, and provide the sheet name.</span>
f<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>sheet_name <span class="token operator">=</span> <span class="token string">'User_info'</span><span class="token punctuation">)</span>
<span class="token comment"># >>>       User Name Country      City Gender  Age</span>
<span class="token comment"># >>> 0  Forrest Gump     USA  New York      M   50</span>
<span class="token comment"># >>> 1     Mary Jane  CANADA   Tornoto      F   30</span>
<span class="token comment"># >>> 2  Harry Porter      UK    London      M   20</span>
<span class="token comment"># >>> 3     Jean Grey   CHINA  Shanghai      F   30</span>

</code></pre>
<h2 id="pdread_excel"><a aria-hidden="true" class="anchor-heading icon-link" href="#pdread_excel"></a>pd.read_excel</h2>
<p><a href="https://pythoninoffice.com/read-multiple-excel-sheets-with-python-pandas/">https://pythoninoffice.com/read-multiple-excel-sheets-with-python-pandas/</a></p>
<pre class="language-python"><code class="language-python"><span class="token comment"># Select sheets to read by index: sheet_name = [0,1,2] means the first three sheets.</span>
<span class="token comment"># Select sheets to read by name: sheet_name = ['User_info', 'compound']. This method requires you to know the sheet names in advance.</span>
<span class="token comment"># Select all sheets: sheet_name = None.</span>

<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'users.xlsx'</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'users.xlsx'</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'User_info'</span><span class="token punctuation">,</span><span class="token string">'compound'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">'users.xlsx'</span><span class="token punctuation">,</span> sheet_name <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token comment"># read all sheets</span>

<span class="token comment"># We will read all sheets from the sample Excel file, then use that dataframe for the examples going forward.</span>

<span class="token comment"># The df returns a dictionary of dataframes. The keys of the dictionary contain sheet names, and values of the dictionary contain sheet content.</span>
df<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># >>> dict_keys(['User_info', 'purchase', 'compound', 'header_row5'])</span>

df<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># >>> dict_values([      User Name Country      City Gender  Age</span>
<span class="token comment"># >>> 0  Forrest Gump     USA  New York      M   50</span>
<span class="token comment"># >>> 1     Mary Jane  CANADA   Tornoto      F   30</span>
<span class="token comment"># >>> 2  Harry Porter      UK    London      M   20</span>
<span class="token comment"># >>> 3     Jean Grey   CHINA  Shanghai      F   30,</span>

<span class="token comment"># >>> ID      Customer            purchase       Date</span>
<span class="token comment"># >>> 0  101  Forrest Gump        Dragon Ball  2020-08-12</span>
<span class="token comment"># >>> 1  102     Mary Jane          Evangelion 2020-01-01</span>
<span class="token comment"># >>> 2  103  Harry Porter        Kill la Kill 2020-08-01</span>
<span class="token comment"># >>> 3  104     Jean Grey        Dragon Ball  1999-01-01</span>
<span class="token comment"># >>> 4  105     Mary Jane          Evangelion 2019-12-31</span>
<span class="token comment"># >>> 5  106  Harry Porter  Ghost in the Shell 2020-01-01</span>
<span class="token comment"># >>> 6  107     Jean Grey          Evangelion 2018-04-01,</span>
<span class="token comment"># >>> ])</span>

<span class="token comment"># To obtain data from a specific sheet, simply reference the key in the dictionary. For example, df['header_row5'] returns the sheet in which data starts from row 5.</span>
df<span class="token punctuation">[</span><span class="token string">'header_row5'</span><span class="token punctuation">]</span>

<span class="token comment"># >>>    Unnamed: 0    Unnamed: 1          Unnamed: 2           Unnamed: 3</span>
<span class="token comment"># >>> 0         NaN           NaN                 NaN                  NaN</span>
<span class="token comment"># >>> 1         NaN           NaN                 NaN                  NaN</span>
<span class="token comment"># >>> 2         NaN           NaN                 NaN                  NaN</span>
<span class="token comment"># >>> 3          ID      Customer            purchase                 Date</span>
<span class="token comment"># >>> 4         101  Forrest Gump        Dragon Ball   2020-08-12 00:00:00</span>
<span class="token comment"># >>> 5         102     Mary Jane          Evangelion  2020-01-01 00:00:00</span>
<span class="token comment"># >>> 6         103  Harry Porter        Kill la Kill  2020-08-01 00:00:00</span>
<span class="token comment"># >>> 7         104     Jean Grey        Dragon Ball   1999-01-01 00:00:00</span>
<span class="token comment"># >>> 8         105     Mary Jane          Evangelion  2019-12-31 00:00:00</span>
<span class="token comment"># >>> 9         106  Harry Porter  Ghost in the Shell  2020-01-01 00:00:00</span>
<span class="token comment"># >>> 10        107     Jean Grey          Evangelion  2018-04-01 00:00:00</span>

</code></pre>