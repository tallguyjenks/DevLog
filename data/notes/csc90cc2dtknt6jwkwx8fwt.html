<h1 id="generate-a-parameter-list-for-all-sql-server-stored-procedures-and-functions"><a aria-hidden="true" class="anchor-heading icon-link" href="#generate-a-parameter-list-for-all-sql-server-stored-procedures-and-functions"></a>Generate a Parameter List for All Sql Server Stored Procedures and Functions</h1>
<h2 id="link"><a aria-hidden="true" class="anchor-heading icon-link" href="#link"></a>Link</h2>
<p><a href="https://www.mssqltips.com/sqlservertip/1669/generate-a-parameter-list-for-all-sql-server-stored-procedures-and-functions/">https://www.mssqltips.com/sqlservertip/1669/generate-a-parameter-list-for-all-sql-server-stored-procedures-and-functions/</a></p>
<h2 id="notes"><a aria-hidden="true" class="anchor-heading icon-link" href="#notes"></a>Notes</h2>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> 
   SCHEMA_NAME<span class="token punctuation">(</span>SO<span class="token punctuation">.</span>SCHEMA_ID<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span><span class="token keyword">Schema</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   SO<span class="token punctuation">.</span>Name <span class="token keyword">AS</span> <span class="token punctuation">[</span>ObjectName<span class="token punctuation">]</span><span class="token punctuation">,</span>
   SO<span class="token punctuation">.</span>Type_Desc <span class="token keyword">AS</span> <span class="token punctuation">[</span>ObjectType <span class="token punctuation">(</span>UDF<span class="token operator">/</span>SP<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   PM<span class="token punctuation">.</span>Parameter_ID <span class="token keyword">AS</span> <span class="token punctuation">[</span>ParameterID<span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token keyword">CASE</span>
      <span class="token keyword">WHEN</span> PM<span class="token punctuation">.</span>Parameter_ID <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">THEN</span> <span class="token string">'Returns'</span>
      <span class="token keyword">ELSE</span> PM<span class="token punctuation">.</span>Name
      <span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>ParameterName<span class="token punctuation">]</span><span class="token punctuation">,</span>
   TYPE_NAME<span class="token punctuation">(</span>PM<span class="token punctuation">.</span>User_Type_ID<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>ParameterDataType<span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token keyword">CASE</span>
      <span class="token keyword">WHEN</span> TYPE_NAME<span class="token punctuation">(</span>PM<span class="token punctuation">.</span>User_Type_ID<span class="token punctuation">)</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'float'</span><span class="token punctuation">,</span> <span class="token string">'uniqueidentifier'</span><span class="token punctuation">,</span> <span class="token string">'datetime'</span><span class="token punctuation">,</span> <span class="token string">'bit'</span><span class="token punctuation">,</span> <span class="token string">'bigint'</span><span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token string">'image'</span><span class="token punctuation">,</span> <span class="token string">'money'</span><span class="token punctuation">,</span> <span class="token string">'xml'</span><span class="token punctuation">,</span> <span class="token string">'varbinary'</span><span class="token punctuation">,</span> <span class="token string">'tinyint'</span><span class="token punctuation">,</span> <span class="token string">'text'</span><span class="token punctuation">,</span> <span class="token string">'ntext'</span><span class="token punctuation">,</span> <span class="token string">'smallint'</span><span class="token punctuation">,</span> <span class="token string">'smallmoney'</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token string">''</span>
      <span class="token keyword">WHEN</span> TYPE_NAME<span class="token punctuation">(</span>PM<span class="token punctuation">.</span>User_Type_ID<span class="token punctuation">)</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'decimal'</span><span class="token punctuation">,</span> <span class="token string">'numeric'</span><span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token string">'('</span> <span class="token operator">+</span> CAST<span class="token punctuation">(</span> PM<span class="token punctuation">.</span><span class="token keyword">Precision</span> <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> CAST<span class="token punctuation">(</span> PM<span class="token punctuation">.</span>Scale <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">')'</span>
      <span class="token keyword">WHEN</span> PM<span class="token punctuation">.</span>Max_Length <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'(Max)'</span>
      <span class="token keyword">WHEN</span> TYPE_NAME<span class="token punctuation">(</span>PM<span class="token punctuation">.</span>User_Type_ID<span class="token punctuation">)</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'nvarchar'</span><span class="token punctuation">,</span> <span class="token string">'nchar'</span> <span class="token punctuation">)</span> <span class="token keyword">THEN</span> CAST<span class="token punctuation">(</span> PM<span class="token punctuation">.</span>Max_Length<span class="token operator">/</span><span class="token number">2</span> <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">ELSE</span> CAST<span class="token punctuation">(</span> PM<span class="token punctuation">.</span>Max_Length <span class="token keyword">AS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>Size<span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token keyword">CASE</span>
      <span class="token keyword">WHEN</span> PM<span class="token punctuation">.</span>Is_Output <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">THEN</span> <span class="token string">'Output'</span>
      <span class="token keyword">ELSE</span> <span class="token string">'Input'</span>
      <span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token punctuation">[</span>Direction<span class="token punctuation">]</span>
<span class="token keyword">FROM</span> sys<span class="token punctuation">.</span>objects <span class="token keyword">AS</span> SO
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> sys<span class="token punctuation">.</span>parameters <span class="token keyword">AS</span> PM 
        <span class="token keyword">ON</span> SO<span class="token punctuation">.</span>OBJECT_ID <span class="token operator">=</span> PM<span class="token punctuation">.</span>OBJECT_ID
<span class="token keyword">WHERE</span> SO<span class="token punctuation">.</span><span class="token keyword">TYPE</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'P'</span><span class="token punctuation">,</span><span class="token string">'FN'</span><span class="token punctuation">)</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> SO<span class="token punctuation">.</span>Type_Desc<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword">Schema</span><span class="token punctuation">]</span><span class="token punctuation">,</span> SO<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> PM<span class="token punctuation">.</span>parameter_id<span class="token punctuation">;</span>
</code></pre>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/DevLog/notes/09s1m81lxifmup1so6qi7u6">2022-03-03 (DevLog)</a></li>
<li><a href="/DevLog/notes/wvzhpkuvjnp9vph5ds5gyu1">Generate a Parameter List for All Sql Server Stored Procedures and Functions (DevLog)</a></li>
</ul>