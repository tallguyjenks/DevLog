<h1 id="an-overview-of-job-scheduling-tools-for-postgresql"><a aria-hidden="true" class="anchor-heading icon-link" href="#an-overview-of-job-scheduling-tools-for-postgresql"></a>An Overview of Job Scheduling Tools for Postgresql</h1>
<p>Reference: <a href="https://severalnines.com/database-blog/overview-job-scheduling-tools-postgresql">https://severalnines.com/database-blog/overview-job-scheduling-tools-postgresql</a></p>
<p>Like <a href="/DevLog/notes/5tw2odx2tt216nylebbpj9w">Sql Agent</a> it is a job scheduling agent available for PostgreSQL that allows the execution of stored procedures, SQL statements, and shell scripts.</p>
<p>The purpose is to have this agent running as a daemon on Linux systems and periodically does a connection to the database to check if there are any jobs to execute.</p>
<p>This scheduling is easily managed by PgAdmin 4, but it’s not installed by default once the pgAdmin installed, it’s necessary to download and install it on your own.</p>
<h2 id="step-1"><a aria-hidden="true" class="anchor-heading icon-link" href="#step-1"></a>Step 1</h2>
<p>Installation of pgAdmin 4</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> pgadmin4 pgadmin4-apache
</code></pre>
<h2 id="step-2"><a aria-hidden="true" class="anchor-heading icon-link" href="#step-2"></a>Step 2</h2>
<p>Creation of plpgsql procedural language if not defined</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> TRUSTED PROCEDURAL <span class="token keyword">LANGUAGE</span> <span class="token string">'plpgsql'</span>
<span class="token keyword">HANDLER</span> plpgsql_call_ <span class="token keyword">handler</span>
<span class="token keyword">HANDLER</span> plpgsql validator<span class="token punctuation">;</span>
</code></pre>
<h2 id="step-3"><a aria-hidden="true" class="anchor-heading icon-link" href="#step-3"></a>Step 3</h2>
<p>Installation of pgAgent</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> pgagent
</code></pre>
<h2 id="step-4"><a aria-hidden="true" class="anchor-heading icon-link" href="#step-4"></a>Step 4</h2>
<p>Creation of the pgagent extension</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> EXTENSION pageant
</code></pre>
<p>In order to define a new job, it's only necessary select "Create" using the right
button on "pgAgent Jobs", and it'll insert a designation for this job and define the
steps to execute it:</p>
<p><img src="/DevLog/assets/images/2022-01-14-23-43-37.png" alt="pgagent"></p>
<p><img src="/DevLog/assets/images/2022-01-14-23-44-04.png" alt="job"></p>
<p><img src="/DevLog/assets/images/2022-01-14-23-44-19.png" alt="schedules"></p>
<h2 id="step-5"><a aria-hidden="true" class="anchor-heading icon-link" href="#step-5"></a>Step 5</h2>
<p>Finally, to have the agent running in the background it's necessary to launch the
following process manually:</p>
<pre class="language-bash"><code class="language-bash">/usr/bin/pgagent <span class="token assign-left variable">host</span><span class="token operator">=</span>localhost <span class="token assign-left variable">dbname</span><span class="token operator">=</span>postgres <span class="token assign-left variable">user</span><span class="token operator">=</span>postgres <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">5432</span> -l <span class="token number">1</span>
</code></pre>